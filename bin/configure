#!/usr/bin/env bash

FILE_PATH="$(pwd)/${BASH_SOURCE[0]}"
BIN_DIR="$(cd "$(dirname "${FILE_PATH}")" && pwd)"

source ${BIN_DIR}/common/config
source ${BIN_DIR}/common/setup ${1}

echo "Bin dir: ${BIN_DIR}"
echo "Project dir: ${PROJECT_DIR}"
echo "Repos dir: ${REPOS_DIR}"

# @todo: make sure this makes sense for both IDE and direct script run
IDE_BUILD_TYPE="opt" # options: debug,opt

if [ "${1}" == "debug" ] ; then
    IDE_BUILD_TYPE="debug"
fi

cd ${BUILD_DIR}

#export ROBOMONG_SHELL_ROOT="${REPOS_DIR}/robomongo-shell"

#echo $ROBOMONGO_CMAKE_PREFIX_PATH

#-D "CMAKE_PREFIX_PATH=${OPENSSL_ROOT};${ROBOMONG_SHELL_ROOT};${ROBOMONG_SHELL_ROOT}/build/${IDE_BUILD_TYPE}" \

cmake \
  -D "CMAKE_PREFIX_PATH=${PREFIX_PATH}" \
  -D "CMAKE_BUILD_TYPE=${BUILD_TYPE}" \
  -D "CMAKE_INSTALL_PREFIX=${INSTALL_PREFIX}" \
  "${@:2}" ${PROJECT_DIR}
