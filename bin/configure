#!/usr/bin/env bash

FILE_PATH="$(pwd)/${BASH_SOURCE[0]}"
BIN_DIR="$(cd "$(dirname "${FILE_PATH}")" && pwd)"

source ${BIN_DIR}/common/setup ${1}

echo "Bin dir: ${BIN_DIR}"
echo "Project dir: ${PROJECT_DIR}"

# @todo: make sure this makes sense for both IDE and direct script run
IDE_BUILD_TYPE="debug" # otherwise: opt?

cmake \
  -D "CMAKE_PREFIX_PATH=${PREFIX_PATH}" \
  -D "CMAKE_BUILD_TYPE=${BUILD_TYPE}" \
  -D "CMAKE_INSTALL_PREFIX=${INSTALL_PREFIX}" \
  -D "CMAKE_PREFIX_PATH=/usr/local/Cellar/openssl/1.0.2t;${REPOS_DIR}/robomongo-shell;${REPOS_DIR}/robomongo-shell/build/${IDE_BUILD_TYPE}" \
  "${@:2}" ${PROJECT_DIR}
